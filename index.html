<!doctype html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description"
        content="Editor de im치genes profesional para Instagram de la Fundaci칩n Ecopiensa Evolution. Recorta, edita y crea contenido visual impactante.">
    <meta name="theme-color" content="#1a1a1a">
    <!-- Removed leading slash for GitHub Pages compatibility -->
    <link rel="manifest" href="public/manifest.json">
    <title>Ecopiensa Editor | Instagram Edition</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Removed leading slash -->
    <link rel="stylesheet" href="src/style.css">
</head>

<body>
    <div id="app">
        <header class="app-header">
            <div class="logo">
                <span class="eco-icon">游꺔</span>
                <h1>Ecopiensa <span class="highlight">Editor</span></h1>
            </div>
            <div class="header-controls">
                <button id="btn-batch" class="btn-secondary" title="Visualizar Grid">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="3" y1="9" x2="21" y2="9"></line>
                        <line x1="3" y1="15" x2="21" y2="15"></line>
                        <line x1="9" y1="3" x2="9" y2="21"></line>
                        <line x1="15" y1="3" x2="15" y2="21"></line>
                    </svg>
                    <span class="btn-text">Grid Visual</span>
                </button>

                <select id="export-format" class="btn-secondary"
                    style="background-color: #0f1115; color: white; border-color: rgba(255,255,255,0.1); cursor: pointer; border-radius: 8px; padding: 0 10px;">
                    <option value="image/png">PNG</option>
                    <option value="image/jpeg">JPG</option>
                    <option value="image/webp">WebP</option>
                </select>

                <button id="btn-export" class="btn-primary">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Exportar
                </button>
            </div>
        </header>

        <main class="editor-workspace">
            <!-- Sidebar: Tools -->
            <aside class="sidebar-tools">
                <div class="tool-group">
                    <h3>B치sicos</h3>
                    <button class="tool-btn active" data-tool="move" title="Mover">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M5 9l-3 3 3 3M9 5l3-3 3 3M19 9l3 3-3 3M15 19l-3 3-3-3M9 9h6v6H9z"></path>
                        </svg>
                    </button>
                    <button class="tool-btn" data-tool="crop" title="Recortar (Instagram)">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M6 2v14a2 2 0 0 0 2 2h14"></path>
                            <path d="M18 22V8a2 2 0 0 0-2-2H2"></path>
                        </svg>
                    </button>
                </div>

                <div class="tool-group">
                    <h3>Creativo</h3>
                    <button class="tool-btn" data-tool="text" title="Texto">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M4 7V4h16v3M9 20h6M12 4v16"></path>
                        </svg>
                    </button>
                    <button class="tool-btn" data-tool="magic-wand" title="Varita M치gica (Quitar Fondo)">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="10" y1="13" x2="8" y2="13"></line>
                            <line x1="6.3" y1="10.7" x2="6.3" y2="10.7"></line>
                        </svg>
                    </button>
                    <button class="tool-btn" data-tool="bucket" title="Bote de Pintura (Rellenar)">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M19 11l-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11z"></path>
                            <path d="M5 2l5 5"></path>
                            <path d="M2 13h15"></path>
                            <path d="M22 13h-4"></path>
                            <path d="M19 16l-3 3"></path>
                        </svg>
                    </button>
                    <button class="tool-btn" data-tool="eraser" title="Borrador Manual">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M20 20H7L3 16C2 15 2 13 3 12L13 2L22 11L20 20Z"></path>
                            <path d="M11 7L20 16"></path>
                        </svg>
                    </button>
                </div>

                <div class="tool-group">
                    <h3>Ajustes</h3>
                    <button class="tool-btn" data-tool="filter" title="Filtros">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                        </svg>
                    </button>
                </div>
            </aside>

            <!-- Main Canvas Area -->
            <section class="canvas-container">
                <div class="canvas-wrapper" id="canvas-wrapper">
                    <div class="empty-state" id="empty-state">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="1" class="upload-icon">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <polyline points="21 15 16 10 5 21"></polyline>
                        </svg>
                        <p>Arrastra im치genes aqu칤 o pega con Ctrl+V</p>
                        <input type="file" id="file-upload" accept="image/*" hidden>
                        <button class="btn-primary-outline"
                            onclick="document.getElementById('file-upload').click()">Seleccionar Imagen</button>
                    </div>
                    <canvas id="editor-canvas"></canvas>
                </div>

                <div class="zoom-controls">
                    <button id="zoom-out">-</button>
                    <span id="zoom-level">100%</span>
                    <button id="zoom-in">+</button>
                </div>
            </section>

            <!-- Right Panel: Properties/Layers -->
            <aside class="sidebar-properties">
                <div class="panel-header">
                    <h2>Propiedades</h2>
                </div>
                <div class="properties-content" id="properties-panel">
                    <p class="hint-text">Selecciona una herramienta o capa para ver las opciones.</p>

                    <div id="general-options" class="options-group">
                        <h3>Organizar</h3>
                        <div class="header-controls"
                            style="justify-content: start; flex-wrap: wrap; margin-bottom: 12px; gap: 8px;">
                            <button class="btn-secondary" id="btn-center" style="padding: 6px;" title="Centrar">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <rect x="2" y="2" width="20" height="20" rx="2"></rect>
                                    <circle cx="12" cy="12" r="2"></circle>
                                </svg>
                            </button>
                            <button class="btn-secondary" id="btn-back" title="Enviar al Fondo">Bajar</button>
                            <button class="btn-secondary" id="btn-front" title="Traer al Frente">Subir</button>
                        </div>
                    </div>

                    <div id="crop-options" class="options-group hidden">
                        <h3>Formato Instagram</h3>
                        <div class="ratio-grid">
                            <button class="ratio-btn" data-ratio="1:1">1:1<br><small>Cuadrado</small></button>
                            <button class="ratio-btn" data-ratio="4:5">4:5<br><small>Retrato</small></button>
                            <button class="ratio-btn" data-ratio="1.91:1">1.91:1<br><small>Paisaje</small></button>
                            <button class="ratio-btn" data-ratio="9:16">9:16<br><small>Historia</small></button>
                        </div>
                    </div>

                    <div id="text-options" class="options-group hidden">
                        <h3>Texto</h3>
                        <div class="input-group">
                            <label>Fuente</label>
                            <select id="font-family">
                                <option value="Outfit">Outfit</option>
                                <option value="Arial">Arial</option>
                                <option value="Times New Roman">Times New Roman</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>Tama침o</label>
                            <input type="range" id="font-size" min="10" max="200" value="40">
                        </div>
                        <div class="input-group">
                            <label>Color</label>
                            <input type="color" id="text-color" value="#ffffff">
                        </div>
                    </div>
                </div>
            </aside>
        </main>
    </div>

    <!-- Grid Preview Modal -->
    <div id="grid-modal" class="modal"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 200; align-items: center; justify-content: center; flex-direction: column;">
        <h2 style="color: #fff; margin-bottom: 20px;">Vista Previa Instagram (Tu Dise침o al Centro)</h2>
        <div id="grid-preview-container"
            style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px; max-width: 400px; width: 100%;">
            <!-- Slots simulating context -->
            <div class="grid-slot" style="aspect-ratio: 1; background: #222;"></div>
            <div class="grid-slot" style="aspect-ratio: 1; background: #222;"></div>
            <div class="grid-slot" style="aspect-ratio: 1; background: #222;"></div>
            <div class="grid-slot" style="aspect-ratio: 1; background: #222;"></div>
            <img id="current-preview" class="grid-slot"
                style="aspect-ratio: 1; width: 100%; object-fit: cover; border: 2px solid #00ff9d;">
            <div class="grid-slot" style="aspect-ratio: 1; background: #222;"></div>
            <div class="grid-slot" style="aspect-ratio: 1; background: #222;"></div>
            <div class="grid-slot" style="aspect-ratio: 1; background: #222;"></div>
            <div class="grid-slot" style="aspect-ratio: 1; background: #222;"></div>
        </div>
        <p style="color: #aaa; margin-top: 20px; text-align: center;">As칤 se destacar치 tu dise침o entre otras
            publicaciones.</p>
        <button id="btn-close-grid" class="btn-primary-outline" style="margin-top: 20px;">Cerrar Visual</button>
    </div>

    <!-- Fixed path for Github Pages compatibility -->
    <script type="module" src="src/main.js"></script>
</body>

</html>
